<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
    <title>{{.Title}} - Proof of Peacemaking</title>
    <link rel="stylesheet" href="/static/css/styles.css">
    <script type="module" src="/static/js/ethers-init.js"></script>
</head>
<body>
    <nav class="navbar">
        <div class="navbar-brand">
            <a href="/" class="logo">Proof of Peacemaking</a>
        </div>
        <div class="navbar-menu">
            <div id="navAuthButtons" style="display: none;" class="nav-auth-items">
                <a href="/feed" class="nav-item">Feed</a>
                <a href="/dashboard" class="nav-item">Dashboard</a>
            </div>
            <button id="connectWallet" class="btn-connect">Connect Wallet</button>
        </div>
    </nav>

    <main class="main-content">
        <div class="home-container">
            <div class="hero-section">
                <h1>Welcome to Proof of Peacemaking</h1>
                <p class="hero-text">A platform for fostering positive interactions and acknowledging peaceful resolutions in the Web3 space.</p>
                <div class="cta-buttons">
                    <button id="connectWalletHero" class="btn-primary">Connect Wallet</button>
                    <div id="authenticatedButtons" style="display: none;">
                        <a href="/feed" class="btn-primary">View Feed</a>
                        <a href="/dashboard" class="btn-secondary">Go to Dashboard</a>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3>About</h3>
                <p>Proof of Peacemaking is a platform for fostering positive interactions and acknowledging peaceful resolutions.</p>
            </div>
            <div class="footer-section">
                <h3>Links</h3>
                <a href="/about">About</a>
                <a href="/terms">Terms</a>
                <a href="/privacy">Privacy</a>
            </div>
            <div class="footer-section">
                <h3>Connect</h3>
                <a href="https://twitter.com" target="_blank">Twitter</a>
                <a href="https://discord.com" target="_blank">Discord</a>
                <a href="https://github.com" target="_blank">GitHub</a>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 Proof of Peacemaking. All rights reserved.</p>
        </div>
    </footer>

    <script src="/static/js/wallet.js"></script>
    <script src="/static/js/main.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const connectWalletHero = document.getElementById('connectWalletHero');
        const authenticatedButtons = document.getElementById('authenticatedButtons');
        const navAuthButtons = document.getElementById('navAuthButtons');

        // Check if wallet is connected
        async function checkWalletConnection() {
            try {
                const response = await fetch('/auth/session');
                const data = await response.json();
                
                if (data.authenticated) {
                    connectWalletHero.style.display = 'none';
                    authenticatedButtons.style.display = 'block';
                    if (navAuthButtons) navAuthButtons.style.display = 'flex';
                } else {
                    connectWalletHero.style.display = 'block';
                    authenticatedButtons.style.display = 'none';
                    if (navAuthButtons) navAuthButtons.style.display = 'none';
                }
            } catch (error) {
                console.error('Error checking wallet connection:', error);
            }
        }

        // Initial check
        checkWalletConnection();

        // Connect wallet when hero button is clicked
        connectWalletHero.addEventListener('click', async () => {
            if (typeof window.ethereum !== 'undefined') {
                try {
                    // This will trigger the wallet connection flow
                    document.getElementById('connectWallet').click();
                } catch (error) {
                    console.error('Error connecting wallet:', error);
                }
            } else {
                alert('Please install MetaMask to use this feature');
            }
        });

        // Listen for wallet connection events
        window.addEventListener('walletConnected', () => {
            checkWalletConnection();
        });

        window.addEventListener('walletDisconnected', () => {
            checkWalletConnection();
        });
    });
    </script>

    <style>
    .home-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 40px 20px;
    }

    .hero-section {
        text-align: center;
        padding: 60px 20px;
    }

    .hero-section h1 {
        font-size: 2.5em;
        color: #333;
        margin-bottom: 20px;
    }

    .hero-text {
        font-size: 1.2em;
        color: #666;
        max-width: 600px;
        margin: 0 auto 40px;
        line-height: 1.6;
    }

    .cta-buttons {
        display: flex;
        gap: 20px;
        justify-content: center;
    }

    .btn-primary {
        padding: 12px 24px;
        background: #4CAF50;
        color: white;
        text-decoration: none;
        border-radius: 4px;
        transition: background-color 0.2s;
        border: none;
        cursor: pointer;
        font-size: 1em;
    }

    .btn-primary:hover {
        background: #43A047;
    }

    .btn-secondary {
        padding: 12px 24px;
        background: #2196F3;
        color: white;
        text-decoration: none;
        border-radius: 4px;
        transition: background-color 0.2s;
    }

    .btn-secondary:hover {
        background: #1E88E5;
    }

    #authenticatedButtons {
        display: flex;
        gap: 1rem;
    }
    </style>
</body>
</html> 